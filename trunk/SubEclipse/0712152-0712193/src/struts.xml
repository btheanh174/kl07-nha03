<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
    "http://struts.apache.org/dtds/struts-2.0.dtd">
<struts>
	<constant name="struts.devMode" value="true"></constant>
	<package name="default"
		extends="struts-default,tiles-default,jcaptcha4struts2-default,json-default">

		<!-- interceptor -->
		<interceptors>
			<interceptor name="LastActionInterceptor" class="action.user.LastActionInterceptor"></interceptor>
			<interceptor-stack name="MyLoginStack">
				<interceptor-ref name="LastActionInterceptor"></interceptor-ref>
				<interceptor-ref name="defaultStack"></interceptor-ref>
			</interceptor-stack>

			<interceptor name="redirectMessage"
				class="action.user.RedirectMessageInterceptor"></interceptor>

		</interceptors>

		<default-interceptor-ref name="paramsPrepareParamsStack"></default-interceptor-ref>
		<!-- end interceptor -->

		<!-- global result -->
		<global-results>
			<result name="error">/global/error.jsp</result>
		</global-results>
		<!-- end global result -->

		<action name="Index">
			<interceptor-ref name="MyLoginStack"></interceptor-ref>
			<result name="success" type="tiles">Index.tiles</result>
		</action>

		<action name="show_*_*">
			<interceptor-ref name="MyLoginStack"></interceptor-ref>
			<result name="success">/{1}/{2}.jsp</result>
		</action>

		<action name="show3_*_*_*">
			<interceptor-ref name="MyLoginStack"></interceptor-ref>
			<result name="success">/{1}/{2}/{3}.jsp</result>
		</action>

		<!-- Dung cho register -->

		<action name="User_register" class="action.user.RegisterAction"
			method="register">
			<interceptor-ref name="jcaptchaDefaultStack" /> <!-- Tich hop jcaptcha4pluginstruts2 -->
			<result name="success" type="redirect">Index.action</result>
			<result name="input" type="redirect">show_user_register.action</result>
			<result name="error" type="tiles">Contact.tiles</result>
		</action>

		<!-- Dung cho login va lost password -->

		<action name="User_login" class="action.user.LoginAction"
			method="login">
			<result name="success" type="redirectAction">
				<param name="actionName">${#session['prevAction']}</param>
			</result>
			<result name="input" type="redirect">show_user_login.action</result>
			<result name="error" type="redirect">show_user_register.action</result>
		</action>

		<action name="User_logout" class="action.user.LogoutAction">
			<result name="success">/user/logout.jsp</result>
			<result name="input" type="redirect">show_index.action</result>
		</action>

		<!-- User profile -->

		<action name="Profile_hienThi" class="action.user.ProfileAction"
			method="hienThi">
			<result name="success" type="redirect">show_myprofile_profile.action
			</result>
		</action>

		<action name="Profile_doiMatKhau" class="action.user.ProfileAction"
			method="doiMatKhau">
			<result name="success">/myprofile/profile.jsp</result>
		</action>

		<action name="Profile_doiEmail" class="action.user.ProfileAction"
			method="doiEmail">
			<result name="success" type="redirect">show_myprofile_profile.action
			</result>
		</action>

		<action name="Profile_capNhatThongTin" class="action.user.ProfileAction"
			method="capNhatThongTin">
			<result name="success" type="redirect">show_myprofile_profile.action
			</result>
			<result name="input" type="redirect">show_myprofile_profile.action
			</result>
		</action>

		<action name="Profile_test" class="action.user.ProfileAction"
			method="test">

			<result name="success" type="redirect">show_index.action</result>
			<result name="input" type="redirect">show_myprofile_profile.action
			</result>
		</action>
		<!-- end Profile -->

		<!-- Store -->
		<action name="Store_hienThi" class="action.gianhang.GianHangAction"
			method="hienThi">
			<result name="success">/myprofile/store.jsp</result>
		</action>
		<action name="Store_capNhat" class="action.gianhang.GianHangAction"
			method="capNhat">
			<interceptor-ref name="fileUpload">
				<param name="allowedTypes">
					image/gif,image/jpeg,image/png
				</param>
			</interceptor-ref>
			<result name="success">/myprofile/store.jsp</result>
		</action>

		<!-- end Store -->

		<!-- Danh muc -->

		<action name="DanhMuc_layDanhSachSanPham" class="action.DanhMucAction"
			method="layDanhSachSanPham">
			<result type="tiles">Products.tiles</result>
			<result name="input" type="tiles">Products.tiles</result>
		</action>

		<action name="DanhMuc_themDanhMuc" class="action.DanhMucAction"
			method="themDanhMuc">
			<result name="success" type="redirect">QuanLyCategories.action</result>
		</action>

		<action name="DanhMuc_xoaDanhMuc" class="action.DanhMucAction"
			method="xoaDanhMuc">
			<result name="success" type="redirect">QuanLyCategories.action</result>
			<result name="input" type="redirect">QuanLyCategories.action</result>
		</action>

		<action name="DanhMuc_capNhatDanhMuc" class="action.DanhMucAction"
			method="capNhatDanhMuc">
			<result name="success" type="redirect">QuanLyCategories.action</result>
			<result name="input" type="redirect">QuanLyCategories.action</result>
			<result name="error">/global/error.jsp</result>
		</action>


		<!-- San pham -->

		<action name="SanPham_chiTiet" class="action.SanPhamAction"
			method="chiTiet">
			<result name="success">/admin/product/detail.jsp</result>
		</action>

		<action name="SanPham_danhSach" class="action.SanPhamAction"
			method="execute">
			<result name="success" type="tiles">Products.tiles</result>
		</action>

		<action name="SanPham_timNhanh" class="action.SanPhamAction"
			method="timNhanh">
			<result name="success">/admin/product/search_results.jsp</result>
			<result name="input" type="redirect">show3_admin_product_search.action
			</result>
		</action>

		<action name="SanPham_timKiem" class="action.XuLyTimKiemAction">
			<result name="dienthoai" type="tiles">DienThoai.Search.tiles</result>
			<result name="laptop" type="tiles">Laptop.Search.tiles</result>
			<result name="error">/global/error.jsp</result>
		</action>

		<action name="SanPham_timNangCao" class="action.SanPhamAction"
			method="timNangCao">
			<result name="success">/admin/product/advancedsearch_results.jsp
			</result>
			<result name="error">/global/error.jsp</result>
		</action>

		<!-- End San pham -->

		<!-- Gio hang -->
		<action name="XemGioHang">
			<result name="success">/content/shoppingcart/shoppingcart.jsp</result>
		</action>

		<action name="GioHang_*" class="action.XuLyGioHangAction"
			method="{1}">
			<result name="success" type="redirect">XemGioHang.action</result>
			<result name="input" type="redirect">show_index.action</result>
		</action>

		<!-- -->

		<!-- Admin -->
		<action name="Admin">
			<interceptor-ref name="MyLoginStack"></interceptor-ref>
			<result name="success">/admin/index.jsp</result>
		</action>

		<action name="QuanLyCategories" class="action.DanhMucAction">
			<result name="success" type="tiles">AdminCategories.tiles</result>
			<result name="input" type="tiles">AdminCategories.tiles</result>
		</action>

		<action name="QuanLyProducts" class="action.SanPhamAction">
			<result name="success" type="tiles">AdminAddProducts1.tiles</result>
			<result name="input" type="tiles">AdminAddProducts1.tiles</result>
		</action>

		<action name="SanPham_themSanPham_*" class="action.SanPhamAction"
			method="themSanPham_step{1}">
			<result name="step2" type="tiles">AdminAddProducts2.tiles</result>
			<result name="success" type="tiles">AdminAddProducts3.tiles</result>
			<result name="finish" type="redirect">show_admin_index.action</result>
		</action>


		<action name="SanPham_xemDanhSachSanPham">
			<result name="success" type="tiles">AdminViewProducts.tiles</result>
			<result name="error" type="redirect">show_admin_index.action</result>
		</action>

		<action name="jsonBangSanPham" class="action.sanpham.JsonTable">
			<result name="success" type="json"></result>
			<result name="error" type="redirect">show_admin_index.action</result>
		</action>

		<action name="TestAction" class="action.DanhMucAction">
			<result name="success">admin/test.jsp</result>
			<result name="input">admin/test.jsp</result>
		</action>
		<!-- end Admin -->

		<!-- sub site -->
		<action name="store" class="action.gianhang.GianHangAction">
			<result name="index">/all/index.jsp</result>
			<result name="intro">/all/intro.jsp</result>
			<result name="contact">/all/contact.jsp</result>
			<result name="policy">/all/policy.jsp</result>
		</action>
		
		<!-- end sub site -->
	</package>

	<!-- sub site -->
	<include file="store-struts.xml"></include>
</struts>