<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
    "http://struts.apache.org/dtds/struts-2.0.dtd">
<struts>
	<constant name="struts.devMode" value="true"></constant>
	<package name="default"
		extends="struts-default,tiles-default,jcaptcha4struts2-default">
		<interceptors>
			<interceptor name="LastActionInterceptor" class="action.user.LastActionInterceptor"></interceptor>
			<interceptor-stack name="MyLoginStack">
				<interceptor-ref name="LastActionInterceptor"></interceptor-ref>
				<interceptor-ref name="defaultStack"></interceptor-ref>
			</interceptor-stack>
			
			<interceptor name="redirectMessage" class="action.user.RedirectMessageInterceptor"></interceptor>
			
		</interceptors>

		<default-interceptor-ref name="paramsPrepareParamsStack"></default-interceptor-ref>
		
		<action name="show_index">
			<interceptor-ref name="MyLoginStack"></interceptor-ref>
			<result name="success" type="tiles">Index.tiles</result>
		</action>

		<action name="show_*_*">
			<interceptor-ref name="MyLoginStack"></interceptor-ref>
			<result name="success">/{1}/{2}.jsp</result>
		</action>

		<action name="show3_*_*_*">
			<result name="success">/{1}/{2}/{3}.jsp</result>
		</action>

		<!-- Dung cho register -->
		
		<action name="User_register" class="action.user.RegisterAction"
			method="register">
			<interceptor-ref name="jcaptchaDefaultStack" /> <!-- Tich hop jcaptcha4pluginstruts2 -->
			<result name="success" type="redirect">show_index.action</result>
			<result name="input" type="redirect">show_user_register.action</result>
			<result name="error" type="tiles">Contact.tiles</result>
		</action>

		<!-- Dung cho login va lost password -->

		<action name="User_login" class="action.user.LoginAction"
			method="login">
			<result name="success" type="redirectAction">
				<param name="actionName">${#session['prevAction']}.action</param>
			</result>
			<result name="input" type="redirect">show_user_login.action</result>
			<result name="error" type="redirect">show_user_register.action</result>
		</action>

		<action name="User_logout" class="action.user.LogoutAction">
			<result name="success">/user/logout.jsp</result>
			<result name="input" type="redirect">show_index.action</result>
		</action>

		<!-- User profile -->
		
		<action name="Profile_hienThi" class="action.user.ProfileAction" method="hienThi">
			<result name="success" type="redirect">show_myprofile_information.action</result>
		</action>
		
		
		<action name="Profile_capNhatThongTin" class="action.user.ProfileAction" method="capNhatThongTin">
			<result name="success" type="redirect">show_myprofile_profile.action</result>
			<result name="input" type="redirect">show_myprofile_information.action</result>
		</action>
		
		<action name="Profile_test" class="action.user.ProfileAction" method="test">

			<result name="success" type="redirect">show_index.action</result>
			<result name="input" type="redirect">show_myprofile_password.action</result>
		</action>

		<!-- Danh muc -->

		<action name="DanhMuc_layDanhSachSanPham" class="action.DanhMucAction"
			method="layDanhSachSanPham">
			<result type="tiles">Products.tiles</result>
			<result name="input" type="tiles">Products.tiles</result>
		</action>

		<action name="DanhMuc_themDanhMuc" class="action.DanhMucAction"
			method="themDanhMuc">
			<result name="success" type="tiles">Categories.tiles</result>
		</action>

		<action name="DanhMuc_xoaDanhMuc" class="action.DanhMucAction"
			method="xoaDanhMuc">
			<result name="success" type="tiles">Categories.tiles</result>
			<result name="input" type="tiles">DeleteCategory.tiles</result>
		</action>

		<!-- San pham -->

		<action name="SanPham_chiTiet" class="action.SanPhamAction"
			method="chiTiet">
			<result name="success">/admin/product/detail.jsp</result>
		</action>

		<action name="SanPham_danhSach" class="action.SanPhamAction"
			method="execute">
			<result name="success" type="tiles">Products.tiles</result>
		</action>
		
		
		<!-- End San pham -->

	</package>
</struts>