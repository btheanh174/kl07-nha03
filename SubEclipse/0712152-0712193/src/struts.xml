<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
    "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
    "http://struts.apache.org/dtds/struts-2.0.dtd">
<struts>
	<constant name="struts.devMode" value="true"></constant>
	<package name="default" extends="struts-default,tiles-default,jcaptcha4struts2-default">
		<interceptors>
			<interceptor name="LastActionInterceptor" class="action.user.LastActionInterceptor"></interceptor>
			<interceptor-stack name="MyLoginStack">
				<interceptor-ref name="LastActionInterceptor"></interceptor-ref>
				<interceptor-ref name="defaultStack"></interceptor-ref>
			</interceptor-stack>
		</interceptors>

		<action name="show_index">
			<interceptor-ref name="MyLoginStack"></interceptor-ref>
			<result name="success" type="tiles">Index.tiles</result>
		</action>

		<action name="show_*_*">
			<interceptor-ref name="MyLoginStack"></interceptor-ref>
			<result name="success">/{1}/{2}.jsp</result>
		</action>

		<!-- Dung cho register -->
		<action name="User_register" class="action.user.RegisterAction"
			method="register">
			<interceptor-ref name="jcaptchaDefaultStack" /> <!-- Tich hop jcaptcha4pluginstruts2 -->
			<result name="success" type="redirect">show_index.action</result>
			<result name="input" type="redirect">show_user_register.action</result>
			<result name="error" type="tiles">Contact.tiles</result>
		</action>

		<!-- Dung cho login va lost password -->

		<action name="User_login" class="action.user.LoginAction"
			method="login">
			<result name="success" type="redirectAction">
				<param name="actionName">${#session['prevAction']}.action</param>
			</result>
			<result name="input" type="redirect">show_user_login.action</result>
			<result name="error" type="redirect">show_user_register.action</result>
		</action>

		<action name="User_logout" class="action.user.LogoutAction">
			<result name="success">/user/logout.jsp</result>
			<result name="input" type="redirect">show_index.action</result>
		</action>

		<!-- User profile -->

		<action name="Profile_password" class="action.user.ProfileAction">
			<result name="success" type="redirect">show_myprofile_profile.action
			</result>
		</action>

		<action name="Profile_information">
			<result name="success" type="tiles">Profile.information.tiles</result>
			<result name="input" type="tiles">Profile.information.tiles</result>
		</action>

		<!-- Danh muc -->
		<action name="DanhMuc_*" class="action.DanhMucAction" method="{1}">
			<result name="success" type="tiles">Products.tiles</result>
		</action>
		
		

	</package>
</struts>